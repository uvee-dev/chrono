{"version":3,"file":"chrono.modern.mjs","sources":["../src/index.js"],"sourcesContent":["class Chrono {\n  constructor() {\n    this.callbacks = [];\n    this.now = performance.now();\n    this.raf = this.raf.bind(this);\n    requestAnimationFrame(this.raf);\n  }\n\n  /**\n   * Adds a callback to the requestAnimationFrame loop with an optional priority.\n   * @param {Function} callback - The function to call each frame.\n   * @param {number} [priority=0] - The priority of the callback. Lower numbers run earlier.\n   * @returns {Function} - A function to remove the callback from the loop.\n   */\n  add(callback, priority = 0) {\n    this.callbacks.push({ callback, priority });\n    this.callbacks.sort((a, b) => a.priority - b.priority);\n\n    return () => this.remove(callback);\n  }\n\n  /**\n   * Removes a callback from the requestAnimationFrame loop.\n   * @param {Function} callback - The function to remove.\n   */\n  remove(callback) {\n    this.callbacks = this.callbacks.filter(({ callback: cb }) => callback !== cb);\n  }\n\n  /**\n   * The requestAnimationFrame loop handler.\n   * @param {number} now - The current timestamp.\n   */\n  raf(now) {\n    requestAnimationFrame(this.raf);\n\n    const deltaTime = now - this.now;\n    this.now = now;\n\n    for (const { callback } of this.callbacks) {\n      callback(now, deltaTime);\n    }\n  }\n}\n\nconst isClient = typeof window !== 'undefined';\nconst chronoInstance = isClient ? new Chrono() : null;\n\nexport default chronoInstance;\n"],"names":["chronoInstance","window","constructor","this","callbacks","now","performance","raf","bind","requestAnimationFrame","add","callback","priority","push","sort","a","b","remove","filter","cb","deltaTime"],"mappings":"AA6CA,MACMA,EAD6B,oBAAXC,OACU,IA9ClC,MACEC,cACEC,KAAKC,UAAY,GACjBD,KAAKE,IAAMC,YAAYD,MACvBF,KAAKI,IAAMJ,KAAKI,IAAIC,KAAKL,MACzBM,sBAAsBN,KAAKI,IAC7B,CAQAG,IAAIC,EAAUC,EAAW,GAIvB,OAHAT,KAAKC,UAAUS,KAAK,CAAEF,WAAUC,aAChCT,KAAKC,UAAUU,KAAK,CAACC,EAAGC,IAAMD,EAAEH,SAAWI,EAAEJ,UAEtC,IAAMT,KAAKc,OAAON,EAC3B,CAMAM,OAAON,GACLR,KAAKC,UAAYD,KAAKC,UAAUc,OAAO,EAAGP,SAAUQ,KAASR,IAAaQ,EAC5E,CAMAZ,IAAIF,GACFI,sBAAsBN,KAAKI,KAE3B,MAAMa,EAAYf,EAAMF,KAAKE,IAC7BF,KAAKE,IAAMA,EAEX,IAAK,MAAMM,SAAEA,UAAmBP,UAC9BO,EAASN,EAAKe,EAElB,GAI+C"}